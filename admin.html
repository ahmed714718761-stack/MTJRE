<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… MTJRE</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --main: #0055ff; --bg: #f0f2f5; --dark: #1e293b; --white: #ffffff; }
        body { font-family: 'Cairo', sans-serif; margin: 0; background: var(--bg); direction: rtl; }
        header { background: var(--dark); color: white; padding: 20px; text-align: center; font-weight: bold; font-size: 20px; }
        
        .container { padding: 20px; max-width: 1200px; margin: auto; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .stat-card { background: white; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .stat-card i { font-size: 30px; color: var(--main); margin-bottom: 10px; }
        .stat-card h3 { margin: 5px 0; font-size: 24px; }
        .stat-card p { margin: 0; color: #64748b; font-size: 14px; }

        .section-title { margin: 30px 0 15px; font-weight: bold; border-right: 5px solid var(--main); padding-right: 15px; }
        
        .table-wrapper { background: white; border-radius: 15px; overflow-x: auto; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        table { width: 100%; border-collapse: collapse; min-width: 600px; }
        th, td { padding: 15px; text-align: right; border-bottom: 1px solid #edf2f7; font-size: 14px; }
        th { background: #f8fafc; color: #64748b; }
        
        .status-badge { padding: 4px 10px; border-radius: 8px; font-size: 11px; font-weight: bold; }
        .status-pending { background: #fff7ed; color: #c2410c; }
        
        .tab-bar { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 10px; }
        .tab-btn { background: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer; font-family: 'Cairo'; font-weight: bold; white-space: nowrap; }
        .tab-btn.active { background: var(--main); color: white; }

        #loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
    </style>
</head>
<body>

<div id="loading-overlay">
    <i class="fa fa-spinner fa-spin" style="font-size: 50px; color: var(--main);"></i>
    <p>Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ¬Ø±Ùƒ...</p>
</div>

<header>
    <i class="fa fa-gauge-high"></i> Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù…ØªØ¬Ø± MTJRE
</header>

<div class="container">
    <div class="stats-grid">
        <div class="stat-card">
            <i class="fa fa-shopping-cart"></i>
            <h3 id="count-orders">0</h3>
            <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</p>
        </div>
        <div class="stat-card">
            <i class="fa fa-users"></i>
            <h3 id="count-visitors">0</h3>
            <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</p>
        </div>
        <div class="stat-card">
            <i class="fa fa-box"></i>
            <h3 id="count-products">0</h3>
            <p>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</p>
        </div>
        <div class="stat-card">
            <i class="fa fa-comment"></i>
            <h3 id="count-comments">0</h3>
            <p>Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</p>
        </div>
    </div>

    <div class="tab-bar">
        <button class="tab-btn active" onclick="showTab('orders')">ğŸ“¦ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
        <button class="tab-btn" onclick="showTab('comments')">ğŸ’¬ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</button>
        <button class="tab-btn" onclick="showTab('visitors')">ğŸ“ˆ Ø§Ù„Ø²ÙˆØ§Ø±</button>
    </div>

    <div id="sec-orders">
        <h3 class="section-title">Ø¢Ø®Ø± Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©</h3>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                        <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                        <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                        <th>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</th>
                        <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                        <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    </tr>
                </thead>
                <tbody id="table-orders"></tbody>
            </table>
        </div>
    </div>

    <div id="sec-comments" style="display:none">
        <h3 class="section-title">ØªØ¹Ù„ÙŠÙ‚Ø§Øª ÙˆØ¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h3>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„Ø§Ø³Ù…</th>
                        <th>Ø§Ù„ØªØ¹Ù„ÙŠÙ‚</th>
                        <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                    </tr>
                </thead>
                <tbody id="table-comments"></tbody>
            </table>
        </div>
    </div>

    <div id="sec-visitors" style="display:none">
        <h3 class="section-title">Ø³Ø¬Ù„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±</h3>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                        <th>Ø§Ù„ØµÙØ­Ø©</th>
                        <th>Ø§Ù„Ø¬Ù‡Ø§Ø²</th>
                        <th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
                    </tr>
                </thead>
                <tbody id="table-visitors"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§ (Ø§Ù„Ø°ÙŠ ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ù€ /exec)
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz0VUtUbUuvDra-WArUQcawRE79M2_Kiw-dxBIPx55vaLrwKv8i2eeXbptsOupFJFab0g/exec';

    async function fetchData() {
        try {
            const res = await fetch(SCRIPT_URL);
            const data = await res.json();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙŠ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
            document.getElementById('count-orders').innerText = data.orders.length - 1;
            document.getElementById('count-visitors').innerText = data.visitors.length - 1;
            document.getElementById('count-products').innerText = data.products.length - 1;
            document.getElementById('count-comments').innerText = data.comments.length - 1;

            // ØªØ¹Ø¨Ø¦Ø© Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ù„ÙÙƒ)
            const ordersHtml = data.orders.slice(1).reverse().map(row => `
                <tr>
                    <td><b>${row[0]}</b></td>
                    <td>${row[1]}</td>
                    <td>${row[2]}</td>
                    <td style="font-size:11px">${row[3]}</td>
                    <td style="color:var(--main); font-weight:bold">${row[4]}</td>
                    <td>${row[5]}</td>
                </tr>
            `).join('');
            document.getElementById('table-orders').innerHTML = ordersHtml;

            // ØªØ¹Ø¨Ø¦Ø© Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª (Ù…Ø«Ù„ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø£Ø±ÙˆÙ‰ ÙˆØ£Ø­Ù…Ø¯)
            const commentsHtml = data.comments.slice(1).reverse().map(row => `
                <tr>
                    <td><b>${row[0]}</b></td>
                    <td>${row[1]}</td>
                    <td>${row[3]}</td>
                    <td><span class="status-badge status-pending">${row[4] || 'Ø¬Ø¯ÙŠØ¯'}</span></td>
                </tr>
            `).join('');
            document.getElementById('table-comments').innerHTML = commentsHtml;

            // ØªØ¹Ø¨Ø¦Ø© Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²ÙˆØ§Ø±
            const visitorsHtml = data.visitors.slice(1).reverse().map(row => `
                <tr>
                    <td>${row[0]}</td>
                    <td>${row[1]}</td>
                    <td>${row[2]}</td>
                    <td>${row[3]}</td>
                </tr>
            `).join('');
            document.getElementById('table-visitors').innerHTML = visitorsHtml;

            document.getElementById('loading-overlay').style.display = 'none';
        } catch (e) {
            alert("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙƒØ±Ø¨Øª.");
        }
    }

    function showTab(tab) {
        document.getElementById('sec-orders').style.display = tab === 'orders' ? 'block' : 'none';
        document.getElementById('sec-comments').style.display = tab === 'comments' ? 'block' : 'none';
        document.getElementById('sec-visitors').style.display = tab === 'visitors' ? 'block' : 'none';
        
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        event.currentTarget.classList.add('active');
    }

    window.onload = fetchData;
</script>
</body>
</html>
